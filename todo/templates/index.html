<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>待办事项</title>
</head>

<body>
<button onclick="showDialog()">添加待办事项</button>
<dialog id="newTodoItem">
    <textarea id="todoText"></textarea>
    <button onclick="hideDialog()">取消</button>
    <button onclick="addTodo()">确定</button>
</dialog>
<ul>
    {% for value in data %}
        <li>
            {{ value[1] }} <button onclick="deleteTodo({{ value[0] }})">删除</button>
        </li>
    {% endfor %}
    </ul>
</body>
<script>
    function deleteTodo(index){
        alert("确定删除？")
        console.log("id:",index)
        fetch("http://127.0.0.1:5000/todo/"+index,{ method:"DELETE" })
            <!--.then(-->
                <!--function (response){-->
                    <!--console.log(response.json());-->
                    <!--return ;-->
                <!--})-->
            .then(function (response){
                window.location.reload();
            })
    }
    function showDialog(index){
        document.getElementById('newTodoItem').showModal();
    }
    function hideDialog(index){
        document.getElementById('newTodoItem').close();
    }

    function addTodo(){
        var text=document.getElementById('todoText').value;
        fetch('http://127.0.0.1:5000/todo',{
            headers:{'Content-Type':'application/json'},
            method:'POST',
            body:JSON.stringify({text:text})
        })
        document.getElementById('newTodoItem').close();
        window.location.reload();
    }
</script>

</html>